<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bello</title>
    <style>
        body,
        html {
            height: 100%;
            margin: 0;
            background-color: black;
            color: white;
            font-family: "Times New Roman", Times, serif;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- Global Elements --- */
        .nyan-cat {
            position: fixed;
            /* Fixed to viewport */
            width: 200px;
            z-index: 10;
            pointer-events: none;
            /* Let clicks pass through */
        }

        /* --- Intro Screen --- */
        #intro-screen {
            text-align: center;
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            /* Content above cat */
        }

        .continue-btn {
            font-size: 3rem;
            font-family: "Times New Roman", Times, serif;
            background: none;
            color: white;
            border: none;
            cursor: pointer;
            text-decoration: none;
            user-select: none;
        }

        .continue-btn:hover {
            text-decoration: underline;
        }

        /* --- Mystery Screen --- */
        #mystery-screen {
            display: none;
            text-align: center;
            flex-direction: column;
            align-items: center;
            font-size: 2rem;
            font-family: "Times New Roman", Times, serif;
            z-index: 30;
            width: 100%;
            height: 100%;
            justify-content: center;
        }

        .mystery-text {
            margin-bottom: 20px;
        }

        .input-word {
            background: transparent;
            border: none;
            border-bottom: 1px solid white;
            color: white;
            font-family: "Times New Roman", Times, serif;
            font-size: 2rem;
            width: 150px;
            text-align: center;
            outline: none;
        }

        .hint-text {
            font-size: 1rem;
            color: #aaaaaa;
            margin-top: 10px;
            font-style: italic;
        }

        /* --- Success Screen --- */
        #success-screen {
            display: none;
            width: 100%;
            height: 100%;
            position: relative;
            /* For absolute explosion */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: black;
            /* Brief flash */
            text-align: center;
            overflow-y: auto;
            /* Allow scroll for long text if needed */
            padding: 20px;
            box-sizing: border-box;
        }

        #success-content-container {
            display: none;
            /* Shows after explosion */
            flex-direction: column;
            align-items: center;
            z-index: 50;
            max-width: 600px;
            width: 100%;
        }

        .explosion-gif {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100vw;
            height: 100vh;
            object-fit: cover;
            z-index: 100;
            pointer-events: none;
        }

        .final-header {
            font-size: 4rem;
            color: white;
            font-family: 'Times New Roman', serif;
            margin-bottom: 30px;
        }

        .final-message {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: left;
            /* Reading ease */
            line-height: 1.6;
            color: white;
            min-height: 300px;
            /* Prevent jumpiness */
        }

        .final-img {
            max-width: 300px;
            border-radius: 10px;
            margin-top: 20px;
        }
    </style>
</head>

<body>

    <!-- GLOBAL: Nyan Cat wandering the entire screen -->
    <img src="../assets/cat.gif" class="nyan-cat" id="nyan-cat" alt="Nyan Cat">

    <!-- INTRO SCREEN -->
    <div id="intro-screen">
        <button id="continue-btn" class="continue-btn">continue</button>
    </div>

    <!-- MYSTERY SCREEN -->
    <div id="mystery-screen">
        <div class="mystery-text">
            Da<input type="text" id="pass-input" class="input-word" autocomplete="off" spellcheck="false"
                maxlength="10">Unicorn101@gmail.com
        </div>
        <div class="hint-text">(security question lolz)</div>
    </div>

    <!-- SUCCESS SCREEN -->
    <div id="success-screen">
        <!-- Explosion removed as per request -->
        <!-- <img id="explosion-img" src="" alt="" class="explosion-gif" style="display:none;"> -->

        <div id="success-content-container">
            <div class="final-header">hey!</div>
            <div id="dynamic-message" class="final-message"></div>
            <button id="next-msg-btn" class="continue-btn" style="font-size: 1.5rem; display: none;">[next]</button>
        </div>
    </div>

    <script>
        // DOM Elements
        const introScreen = document.getElementById('intro-screen');
        const continueBtn = document.getElementById('continue-btn');
        const mysteryScreen = document.getElementById('mystery-screen');
        const passInput = document.getElementById('pass-input');
        const successScreen = document.getElementById('success-screen');
        const successContentFn = document.getElementById('success-content-container');
        // const explosionImg = document.getElementById('explosion-img'); // Removed
        const nyanCat = document.getElementById('nyan-cat');

        // --- Bouncing Logic (DVD Screensaver Style) ---
        let x = Math.random() * (window.innerWidth - 200);
        let y = Math.random() * (window.innerHeight - 120);
        let dx = 3 * (Math.random() > 0.5 ? 1 : -1);
        let dy = 3 * (Math.random() > 0.5 ? 1 : -1);
        let catWidth = 200;
        let catHeight = 120; // Approx visible height

        function animateCat() {
            const width = window.innerWidth;
            const height = window.innerHeight;

            if (x + catWidth >= width || x <= 0) {
                dx = -dx;
            }
            if (y + catHeight >= height || y <= 0) {
                dy = -dy;
            }

            x += dx;
            y += dy;

            nyanCat.style.left = x + 'px';
            nyanCat.style.top = y + 'px';

            // Mirror if moving left
            if (dx < 0) {
                nyanCat.style.transform = 'scaleX(-1)';
            } else {
                nyanCat.style.transform = 'scaleX(1)';
            }

            requestAnimationFrame(animateCat);
        }

        // Start animation
        animateCat();


        // --- Interaction Logic ---

        // Reveal Continue button slowly - REMOVED
        // setTimeout(() => {
        //     continueBtn.style.opacity = '1';
        // }, 1000);

        continueBtn.addEventListener('click', () => {
            introScreen.style.display = 'none';
            mysteryScreen.style.display = 'flex';
            passInput.focus();
        });

        passInput.addEventListener('input', (e) => {
            const val = e.target.value.toLowerCase().trim();
            if (val === 'dark') {
                triggerSuccess();
            }
        });

        function triggerSuccess() {
            mysteryScreen.style.display = 'none';
            successScreen.style.display = 'flex';
            successScreen.style.backgroundColor = 'black'; // Ensure black

            // Hide Nyan cat
            nyanCat.style.display = 'none';

            // No explosion, just show content immediately
            successContentFn.style.display = 'flex';
            successContentFn.style.opacity = '1';

            startTypewriter();
        }

        // --- Typewriter & Pagination Logic ---
        const messagePart1 = [
            "i know this is super random buttttt",
            "",
            "i feel like we stopped talking over some really stupid stuff and drama ",
            "and i hate that sm and i know times passed since then sooo",
            "",
            "i would love to just talk about stuff and move past it",
            "and also just catch up bc life is so awesome when we r friends",
            "",
            "with that being said i do wanna say sorry for a bunch of stuff.",
            "mainly for like half assed reaching out over break",
            "",
            "last time when i tried tty i was kinda j hurt that my text got dubbed",
            "but really i should've j made it clearer that i really wanted to fix things",
            "",
            "but anyways i hope this (gift) i ended up sending u is a cool peace offering :)",
            "",
            "i really miss u man and would love to catch up and hangout"
        ];

        const messagePart2 = [
            "if this message was compelling enough",
            "pls shoot me a text so i can figure out a place for us to get coffee soon ",
            "inshAllah",
            "also Ramadan Mubarak :D",
            "regardless tho, stay goated",
            "- maani"

        ];

        let currentPart = 1;
        const msgContainer = document.getElementById('dynamic-message');
        const nextBtn = document.getElementById('next-msg-btn');

        async function startTypewriter() {
            // Render Part 1
            await typeLines(messagePart1);

            // Show Next Button
            nextBtn.style.display = 'block';
            nextBtn.style.opacity = '1';
        }

        nextBtn.addEventListener('click', async () => {
            if (currentPart === 1) {
                // Clear and start Part 2
                msgContainer.innerHTML = '';
                nextBtn.style.display = 'none';

                // Hide header
                document.querySelector('.final-header').style.display = 'none';

                currentPart = 2;
                await typeLines(messagePart2);
            }
        });

        async function typeLines(lines) {
            for (let line of lines) {
                const p = document.createElement('div');
                p.style.minHeight = '1.2em'; // Maintain height for empty lines
                msgContainer.appendChild(p);

                if (line.trim() === "") {
                    await new Promise(r => setTimeout(r, 100)); // Short pause for breaks
                    continue;
                }

                // Type words
                const words = line.split(" ");
                for (let i = 0; i < words.length; i++) {
                    const span = document.createElement('span');
                    span.textContent = words[i] + " ";
                    span.style.opacity = '0';
                    span.style.transition = 'opacity 0.2s ease';
                    p.appendChild(span);

                    // Reveal
                    // small delay to let DOM render
                    await new Promise(r => requestAnimationFrame(r));
                    span.style.opacity = '1';

                    await new Promise(r => setTimeout(r, 50)); // Typing speed per word
                }
                await new Promise(r => setTimeout(r, 300)); // Pause after line
            }
        }
    </script>
</body>

</html>