<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bello</title>
    <style>
        body,
        html {
            height: 100%;
            margin: 0;
            background-color: black;
            color: white;
            font-family: "Times New Roman", Times, serif;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            /* Prevent scroll */
        }

        .container {
            text-align: center;
            animation: fadeIn 2s ease-in-out;
            width: 100%;
            max-width: 600px;
            /* Constrain width for readability */
            padding: 20px;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Calendar Styles */
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .day-header {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .day {
            padding: 10px;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.3s ease;
        }

        .day:hover {
            border-color: rgba(255, 255, 255, 0.5);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .empty-day {
            cursor: default;
        }

        .month-header {
            font-size: 2rem;
            margin-bottom: 2rem;
            text-transform: lowercase;
            /* match "march" style if needed, but going standard for now */
        }

        /* Input Style */
        .date-input {
            background: transparent;
            border: none;
            border-bottom: 1px solid white;
            color: white;
            font-family: "Times New Roman", Times, serif;
            font-size: 1.5rem;
            text-align: center;
            width: 200px;
            margin-top: 20px;
            outline: none;
        }

        .date-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        /* Invitation Styles */
        #invitation-container {
            display: none;
            /* Center the block, but keep text left-aligned like a document */
            width: fit-content;
            margin: 0 auto;
            text-align: left;
            font-size: 1.2rem;
            line-height: 1.6;
            min-height: 50vh;
            /* Ensure it takes up some vertical space if needed, though flexible is fine */
        }

        a {
            color: white;
            text-decoration: underline;
        }

        /* Typewriter Cursor & Hidden Text */
        .hidden-char {
            opacity: 0;
        }

        .visible-char {
            opacity: 1;
            transition: opacity 0.05s ease;
        }

        .cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background-color: white;
            animation: blink 1s step-end infinite;
            vertical-align: middle;
            margin-left: 1px;
            /* Absolute positioning relative to the text flow was tricky, 
               so we will physically move this element in the DOM */
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <div id="gate-container" class="container">
        <div class="month-header">october 2022</div>
        <div class="calendar" id="calendar">
            <!-- Days will be generated by JS -->
        </div>
        <div>
            <input type="text" id="date-input" class="date-input" placeholder="mm/dd/yyyy" autocomplete="off">
        </div>
    </div>

    <div id="invitation-container">
        <div id="typewriter-text"></div>
    </div>

    <script>
        const gateContainer = document.getElementById('gate-container');
        const invitationContainer = document.getElementById('invitation-container');
        const calendarEl = document.getElementById('calendar');
        const dateInput = document.getElementById('date-input');
        const typewriterTextEl = document.getElementById('typewriter-text');

        // Create cursor element to move around
        const cursor = document.createElement('span');
        cursor.className = 'cursor';

        // Calendar Logic for Oct 2022
        // Oct 1, 2022 was a Saturday (Day 6, if Sun=0)
        const daysInMonth = 31;
        const firstDayIndex = 6; // 0=Sun, 1=Mon, ..., 6=Sat

        const daysOfWeek = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];

        // Add headers
        daysOfWeek.forEach(day => {
            const el = document.createElement('div');
            el.className = 'day-header';
            el.innerText = day;
            calendarEl.appendChild(el);
        });

        // Add empty cells
        for (let i = 0; i < firstDayIndex; i++) {
            const el = document.createElement('div');
            el.className = 'day empty-day';
            calendarEl.appendChild(el);
        }

        // Add days
        for (let i = 1; i <= daysInMonth; i++) {
            const el = document.createElement('div');
            el.className = 'day';
            el.innerText = i;
            el.dataset.day = i;

            el.addEventListener('click', () => {
                if (i === 16) {
                    revealInvitation();
                } else {
                    // Minimalist: do nothing
                }
            });

            calendarEl.appendChild(el);
        }

        // Input Logic
        dateInput.addEventListener('input', (e) => {
            const val = e.target.value.trim();
            if (val === '16' || val === '10/16/2022' || val === '10/16') {
                revealInvitation();
            }
        });

        function revealInvitation() {
            // Fade out gate
            gateContainer.style.opacity = '0';
            gateContainer.style.transition = 'opacity 1s ease';

            setTimeout(() => {
                gateContainer.style.display = 'none';

                // Prepare the text (but keep it invisible)
                prepareTypewriterContent();

                invitationContainer.style.display = 'block';
                invitationContainer.style.opacity = '0';

                // Fade in invitation container
                setTimeout(() => {
                    invitationContainer.style.transition = 'opacity 1s ease';
                    invitationContainer.style.opacity = '1';

                    // Start revealing characters
                    revealCharacters();
                }, 50);
            }, 1000);
        }

        // Typewriter Logic
        const lines = [
            { type: 'text', content: 'hey heeb\n\n' },
            { type: 'text', content: 'i know this is really random but i wanted to reach out one last time\n\n' },
            { type: 'text', content: 'it would mean a lot if we could talk\n\n' },
            { type: 'text', content: 'ill be here on monday at 6\n\n' },
            { type: 'link', content: '40.510107, -74.569214', href: 'https://maps.app.goo.gl/eMyUwuvtXXy1rVP97' },
            { type: 'text', content: '\n2/16/2026, 18:00\n\n' },
            { type: 'text', content: 'if not, i completely get it\n\n' },
            { type: 'text', content: 'wishing you well\n\n' },
            { type: 'text', content: 'â€” maani' }
        ];

        let revealQueue = []; // Array of span elements or break markers

        function prepareTypewriterContent() {
            typewriterTextEl.innerHTML = '';
            revealQueue = [];

            lines.forEach(line => {
                const container = line.type === 'link' ? document.createElement('a') : document.createDocumentFragment();
                if (line.type === 'link') {
                    container.href = line.href;
                    container.target = '_blank';
                }

                // Process char by char
                const chars = line.content.split('');
                chars.forEach(char => {
                    if (char === '\n') {
                        const br = document.createElement('br');
                        container.appendChild(br);
                        revealQueue.push({ isBr: true, el: br });
                    } else {
                        const span = document.createElement('span');
                        span.textContent = char;
                        span.className = 'hidden-char';
                        container.appendChild(span);
                        revealQueue.push({ isBr: false, el: span });
                    }
                });

                typewriterTextEl.appendChild(container);
            });

            // Append cursor at start
            typewriterTextEl.prepend(cursor);
        }

        function revealCharacters() {
            if (revealQueue.length === 0) {
                cursor.style.display = 'none';
                return;
            }

            const nextItem = revealQueue.shift();

            if (nextItem.isBr) {
                // It's a break. Move cursor after it.
                nextItem.el.after(cursor);
                // Pause slightly for newline (natural typing pause)
                setTimeout(revealCharacters, 300);
            } else {
                // Reveal char
                nextItem.el.className = 'visible-char';
                // Move cursor after this char
                nextItem.el.after(cursor);

                // Random typing speed
                setTimeout(revealCharacters, 30 + Math.random() * 50);
            }
        }
    </script>
</body>

</html>